/* Mobile Scroll Fixes - Ensures smooth scrolling on mobile devices */

/* Critical fixes for mobile viewports */
@media (max-width: 768px) {
  /* Reset html and body to allow natural scrolling */
  html {
    overflow-x: hidden !important;
    overflow-y: auto !important;
    height: auto !important;
    width: 100% !important;
    position: relative !important;
  }
  
  body {
    overflow-x: hidden !important;
    overflow-y: auto !important;
    height: auto !important;
    min-height: 100vh !important;
    width: 100% !important;
    position: relative !important;
    /* Allow vertical scrolling, prevent horizontal */
    touch-action: pan-y !important;
    /* Allow default overscroll behavior */
    overscroll-behavior-y: auto !important;
    overscroll-behavior-x: none !important;
  }
  
  /* Ensure main containers don't trap scrolling */
  #root,
  #__next,
  .App,
  .mobile-app,
  main,
  .mobile-main {
    overflow-x: hidden !important;
    overflow-y: visible !important;
    height: auto !important;
    min-height: 100vh;
    position: relative !important;
    /* Don't trap scrolling */
    overscroll-behavior: auto !important;
  }
  
  /* Remove fixed heights that might trap scrolling */
  .mobile-content,
  .mobile-section,
  .mobile-section-list {
    height: auto !important;
    overflow-y: visible !important;
    overflow-x: hidden !important;
    position: relative !important;
  }
  
  /* Ensure modals/overlays don't block body scroll on mobile */
  body.menu-open,
  body.filter-open,
  body.modal-open {
    overflow-y: auto !important;
    position: relative !important;
    height: auto !important;
  }
  
  /* Fix sticky elements that might interfere with scrolling */
  .mobile-header,
  .mobile-filter-section {
    position: relative !important; /* Remove sticky on mobile */
  }
  
  /* Ensure buttons only use manipulation where needed */
  button,
  a,
  [role="button"] {
    touch-action: manipulation;
  }
  
  /* But allow scrolling on containers */
  div,
  section,
  article,
  main {
    touch-action: auto !important;
  }
  
  /* Special handling for filter and menu overlays */
  .mobile-filter-overlay,
  .mobile-menu-overlay {
    /* Allow scroll pass-through if needed */
    pointer-events: auto;
    touch-action: auto;
  }
  
  /* Ensure filter sheet doesn't block scrolling when closed */
  .mobile-filter-sheet:not(.open) {
    pointer-events: none !important;
  }
  
  /* Fix filter body scrolling */
  .mobile-filter-body {
    overflow-y: auto !important;
    overflow-x: hidden !important;
    -webkit-overflow-scrolling: touch !important;
    max-height: calc(85vh - 120px) !important;
  }
  
  /* Ensure filter content doesn't block page scroll */
  .mobile-filter-content {
    touch-action: pan-y !important;
  }
  
  /* Fix any viewport height issues */
  .vh-100 {
    height: auto !important;
    min-height: 100vh !important;
    min-height: 100dvh !important;
  }
}

/* Additional fixes for very small devices */
@media (max-width: 480px) {
  body {
    -webkit-overflow-scrolling: touch !important;
  }
  
  /* Ensure no element uses fixed positioning that might block scroll */
  .mobile-sun-banner {
    position: relative !important;
  }
}

/* Landscape mode fixes */
@media (max-height: 600px) and (orientation: landscape) {
  body {
    overflow-y: auto !important;
    height: auto !important;
  }
  
  .mobile-app {
    min-height: 100vh !important;
    height: auto !important;
  }
}

/* iOS-specific fixes */
@supports (-webkit-touch-callout: none) {
  @media (max-width: 768px) {
    body {
      -webkit-overflow-scrolling: touch !important;
      position: relative !important;
    }
    
    /* Fix iOS rubber-band scrolling */
    .mobile-app {
      -webkit-overflow-scrolling: touch !important;
    }
  }
}

/* Android-specific fixes */
@media (max-width: 768px) {
  /* Prevent pull-to-refresh from interfering */
  body {
    overscroll-behavior-y: contain;
  }
  
  /* But allow it on the main app container */
  .mobile-app {
    overscroll-behavior-y: auto;
  }
}